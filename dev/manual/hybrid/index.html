<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hybrid MPC · LinearMPC.jl</title><meta name="title" content="Hybrid MPC · LinearMPC.jl"/><meta property="og:title" content="Hybrid MPC · LinearMPC.jl"/><meta property="twitter:title" content="Hybrid MPC · LinearMPC.jl"/><meta name="description" content="Documentation for LinearMPC.jl."/><meta property="og:description" content="Documentation for LinearMPC.jl."/><meta property="twitter:description" content="Documentation for LinearMPC.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LinearMPC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simple/">Simple example</a></li><li><a class="tocitem" href="../model/">Models</a></li><li><a class="tocitem" href="../objective/">Objective function</a></li><li><a class="tocitem" href="../constraints/">Constraints</a></li><li><a class="tocitem" href="../observer/">State observer</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Beyond the basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../prestab/">Prestabilization</a></li><li><a class="tocitem" href="../moveblock/">Move blocking </a></li><li><a class="tocitem" href="../reference_preview/">Reference Preview</a></li><li><a class="tocitem" href="../explicit/">Explict MPC</a></li><li class="is-active"><a class="tocitem" href>Hybrid MPC</a><ul class="internal"><li><a class="tocitem" href="#Illustrative-example"><span>Illustrative example</span></a></li></ul></li><li><a class="tocitem" href="../robust/">Robust MPC</a></li><li><a class="tocitem" href="../game/">Game-Theoretic MPC</a></li><li><a class="tocitem" href="../linear_cost/">Linear control cost</a></li><li><a class="tocitem" href="../solver/">Solver Settings</a></li></ul></li></ul></li><li><a class="tocitem" href="../../functions/">Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">Beyond the basics</a></li><li class="is-active"><a href>Hybrid MPC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hybrid MPC</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/darnstrom/LinearMPC.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/darnstrom/LinearMPC.jl/blob/main/docs/src/manual/hybrid.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="man_hybridmpc"><a class="docs-heading-anchor" href="#man_hybridmpc">Hybrid MPC</a><a id="man_hybridmpc-1"></a><a class="docs-heading-anchor-permalink" href="#man_hybridmpc" title="Permalink"></a></h1><p><strong>LinearMPC.jl</strong> can be used to control hybrid systems, where controls and states might take both continuous and binary values.</p><p>Binary controls are either equal to its upper or lower bound. For example, if the lower and upper bounds for the control <span>$i$</span> is <span>$\underline{u}_i$</span> and <span>$\overline{u}_i$</span>, making <span>$u_i$</span> binary means that <span>$u_i \in \{\underline{u}_i, \overline{u}_i\}$</span> rather than <span>$\underline{u}_i \leq u_i \leq \overline{u}_i$</span>. Controls can be made binary with the function <code>set_binary_controls!</code>, which is exemplified below.</p><p>More generally, <strong>LinearMPC.jl</strong> allows any constraint to be defined as <code>binary</code>. A constraint can be enforced to be binary by settings the setting the optional argument <code>binary</code> to  <code>true</code> in the functions <code>add_constraint!</code>.</p><h2 id="Illustrative-example"><a class="docs-heading-anchor" href="#Illustrative-example">Illustrative example</a><a id="Illustrative-example-1"></a><a class="docs-heading-anchor-permalink" href="#Illustrative-example" title="Permalink"></a></h2><p>As an illustrative example, we consider the control of the attitude of a satellite<sup class="footnote-reference"><a id="citeref-Axehill04" href="#footnote-Axehill04" class="footnote-ref">[Axehill04]</a><span class="footnote-preview" id="fn-Axehill04"></span></sup>. The actuators consist of one reaction wheel and two thrusters. The thruster takes on binary values (they are either &#39;on&#39; or &#39;off&#39;)</p><p>The dynamics of the system is given by</p><p class="math-container">\[\dot{x} = \begin{bmatrix}
    0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 0 
\end{bmatrix} x  
+ \begin{bmatrix}
    0 &amp; 0 &amp; 0 \\
    2.5 &amp; 1 &amp; 1 \\
    -10 &amp; 0 &amp; 0
\end{bmatrix}
\begin{bmatrix}
 u_1 \\
 u_2 \\
 u_3 
\end{bmatrix}\]</p><p>where <span>$x_1$</span> i the attitude of the satellite. </p><p>The thrusters give rise to the binary controls <span>$u_2 \in \{0,1\}$</span> and <span>$u_3 \in \{-1,0\}$</span>.</p><p>An MPC controller that controls the attitude of the satellite can be set up with <strong>LinearMPC.jl</strong> as follows: </p><pre><code class="language-julia hljs">using LinearMPC
# Setup dynamics + horizon
A = [0.0 1 0; 0 0 0; 0 0 0]
B = [0 0 0; 2.5 1 1; -10 0 0]
mpc = LinearMPC.MPC(A,B,0.1;Np=20)

# Setup the binary controls u_2 {0,1} and u3 in {-1,0}
set_binary_controls!(mpc,[2,3])
set_bounds!(mpc;umin=[-Inf;0;-1],umax=[Inf;1;0])

# Setup objetive to prioritize tracking of the attitude x1
set_objective!(mpc;Q=[0.5e4, 1e-2, 1e-1], R = [10,10,10], Rr = 0)

# Enable reference preview
mpc.settings.reference_preview = true</code></pre><div class="admonition is-info" id="Binary-control-horizon-a90483c77ab2e708"><header class="admonition-header">Binary control horizon<a class="admonition-anchor" href="#Binary-control-horizon-a90483c77ab2e708" title="Permalink"></a></header><div class="admonition-body"><p><code>set_binary_controls!</code> takes in a third argument which specifies for how many time step the control should be binary (by default, this is equal to the control horizon.) After the binary control horizon, the control is allowed to take continuous values, which can reduce the computational time significantly, with minor effect on the solution.</p></div></div><p>We simulate the controller with an attitude reference change to 0.5 after 5 time steps with the following code</p><pre><code class="language-julia hljs">x0, N = zeros(3), 20;
rs = [zeros(1,5) 0.5*ones(1,N-5);
      zeros(2,N)];
dynamics = (x,u,d) -&gt; mpc.model.F*x + mpc.model.G*u
sim = LinearMPC.Simulation(dynamics, mpc; x0,N, r=rs)</code></pre><p>The result of the simulation can be plotted with </p><pre><code class="language-julia hljs">using Plots
plot(sim)</code></pre><img src="f925f733.svg" alt="Example block output"/><p>We can see that the attitude is able to reach the setpoint of 0.5. Moreover, we also we that <span>$u_2$</span> and <span>$u_3$</span> only take values in <span>$\{0,1\}$</span> and <span>$\{-1,0\}$</span>, respectively.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Axehill04"><a class="tag is-link" href="#citeref-Axehill04">Axehill04</a>Axehill, Daniel, and Hansson, Anders. &quot;A preprocessing algorithm for MIQP solvers with applications to MPC.&quot; <em>43rd IEEE Conference on Decision and Control (CDC)</em> (2004) </li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../explicit/">« Explict MPC</a><a class="docs-footer-nextpage" href="../robust/">Robust MPC »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 19 January 2026 17:00">Monday 19 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
